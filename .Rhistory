cinema <- read.csv("Databases/Kaggle_movies.csv")
getwd()
setwd("D:/ODTU/Sem 4/STAT250/STAT250-Final-Project")
cinema <- read.csv("Databases/Kaggle_movies.csv")
## We are interested about profit of the movies so i add a profit column.
cinema  <- cinema %>%
mutate(profit = gross - budget)
libs <- c("ggplot2", "dplyr", "readr", "magrittr", "jsonlite")
lapply(libs, require, character.only = TRUE)
## We are interested about profit of the movies so i add a profit column.
cinema  <- cinema %>%
mutate(profit = gross - budget)
is.na(cinema)
na.omit(cinema)
sum(is.na(cinema))
colSums(is.na(cinema))
cinema_clean <- cinema %>%
filter(!is.na(profit) & !is.na(gross) & !is.na(budget))
sum(is.na(cinema_clean)) ## still 1
cinema_clean <- cinema_clean %>%
filter(!is.na(runtime))
sum(is.na(cinema_clean))
##colnames(cinema)
cinema_clean %>%
filter(genre == "Drama") %>%
nrow()
##Extract most profitable 5 directors for action genre.
action_directors <- cinema_clean %>%
filter(genre=="Action") %>%
group_by(director) %>%
summarise(total_profit =sum(profit,na.rm = TRUE)) %>%
arrange(desc(total_profit)) %>%
slice_head(n=15)
action_directors
drama_directors <- cinema_clean %>%
filter(genre == "Drama") %>%
group_by(director) %>%
summarise(total_profit = sum(profit, na.rm = TRUE)) %>%
arrange(desc(total_profit)) %>%
slice_head(n = 15)
## Combine most profitable directors and their profits in drama genre.
## There are giants like Clint Eastwood, Steven Spielberg, James Cameron.
top_drama_directors <- drama_directors$director
top_drama_directors
action_profits <- cinema_clean %>%
filter(director %in% top_action_directors & genre == "Action") %>%
select(director, profit)
drama_directors <- cinema_clean %>%
filter(genre == "Drama") %>%
group_by(director) %>%
summarise(total_profit = sum(profit, na.rm = TRUE)) %>%
arrange(desc(total_profit)) %>%
slice_head(n = 15)
## Combine most profitable directors and their profits in drama genre.
## There are giants like Clint Eastwood, Steven Spielberg, James Cameron.
top_drama_directors <- drama_directors$director
drama_profits <- cinema_clean %>%
filter(director %in% top_drama_directors & genre == "Drama") %>%
select(director, profit)
drama_profits
## Combine most profitable directors and their profits in action genre.
## There are giants like J.J Abrams, Michael Bay and James Cameron.
top_action_directors <- action_directors$director
action_profits <- cinema_clean %>%
filter(director %in% top_action_directors & genre == "Action") %>%
select(director, profit)
action_profits
# Combine the profits data for the t-test
combined_profits <- rbind(
data.frame(director = drama_profits$director, profit = drama_profits$profit, genre = "Drama"),
data.frame(director = action_profits$director, profit = action_profits$profit, genre = "Action")
)
combined_profits
top_drama_directors
nrow(drama_profits)
nrow(action_profits)
combined_profits
# Separate the profits by genre
drama_profit_values <- combined_profits %>%
filter(genre == "Drama") %>%
pull(profit)
drama_profit_values
action_profit_values <- combined_profits %>%
filter(genre == "Action") %>%
pull(profit)
action_profit_values
source("D:/ODTU/Sem 4/STAT250/STAT250-Final-Project/Main EDA.R", echo=TRUE)
sum(is.na(kg))
kg[is.na(kg), ]
is.na(kg)
which(is.na(kg))
kg[80250, ]
kg[80251, ]
kg[8024.1, ]
kg[80241, ]
nrow(kg)
tail(kg)
##colnames(cinema)
kg %>%
filter(genre == "Drama") %>%
nrow()
##Extract most profitable 15 directors for action genre.
action_directors <- kg %>%
filter(genre=="Action") %>%
group_by(director) %>%
summarise(total_profit =sum(profit,na.rm = TRUE)) %>%
arrange(desc(total_profit)) %>%
slice_head(n=15)
drama_directors <- kg %>%
filter(genre == "Drama") %>%
group_by(director) %>%
summarise(total_profit = sum(profit, na.rm = TRUE)) %>%
arrange(desc(total_profit)) %>%
slice_head(n = 15)
## Combine most profitable directors and their profits in drama genre.
## There are giants like Clint Eastwood, Steven Spielberg, James Cameron.
top_drama_directors <- drama_directors$director
drama_profits <- kg %>%
filter(director %in% top_drama_directors & genre == "Drama") %>%
select(director, profit)
drama_profits
## Combine most profitable directors and their profits in action genre.
## There are giants like J.J Abrams, Michael Bay and James Cameron.
top_action_directors <- action_directors$director
action_profits <- kg %>%
filter(director %in% top_action_directors & genre == "Action") %>%
select(director, profit)
action_profits
# Combine the profits data for the t-test
combined_profits <- rbind(
data.frame(director = drama_profits$director, profit = drama_profits$profit, genre = "Drama"),
data.frame(director = action_profits$director, profit = action_profits$profit, genre = "Action")
)
# Print combined profits data for verification
print(combined_profits)
# Separate the profits by genre
drama_profit_values <- combined_profits %>%
filter(genre == "Drama") %>%
pull(profit)
action_profit_values <- combined_profits %>%
filter(genre == "Action") %>%
pull(profit)
drama_profit_values
action_profit_values
t_test_result <- t.test(drama_profit_values, action_profit_values)
t_test_result
